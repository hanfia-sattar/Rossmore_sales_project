import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import plotly.express as px
import plotly.graph_objects as go
import os
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense
from datetime import timedelta

# Streamlit page configuration
st.set_page_config(page_title="Rossmore Sales Forecasting", layout="wide", page_icon="ğ")

# Custom CSS for professional look
st.markdown("""
    <style>
    .main {background-color: #f5f7fa;}
    .stSidebar {background-color: #e6e9ef;}
    .stButton>button {background-color: #4a6fa5partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partnels/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/part Wes/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/partners/part


    .stSelectbox, .stSlider {background-color: white; border-radius: 5px;}
    h1 {color: #2c3e50; font-family: 'Arial';}
    h2, h3 {color: #34495e;}
    .stPlotlyChart {background-color: white; border-radius: 5px; padding: 10px;}
    </style>
""", unsafe_allow_html=True)

# Function to load and preprocess data (updated for CSV)
@st.cache_data
def load_data(file_path="Data/train.csv"):
    # Ensure the file path is valid
    file_path = os.path.join(os.getcwd(), file_path)  # Convert to absolute path
    if not os.path.exists(file_path):
        st.error(f"File not found: {file_path}")
        return pd.DataFrame()  # Return an empty DataFrame if the file is missing

    # Load the CSV file
    df = pd.read_csv(file_path)
    df['Date'] = pd.to_datetime(df['Date'])
    df.set_index('Date', inplace=True)
    return df

# Function to prepare data for LSTM
def prepare_data(series, time_steps=12):
    scaler = MinMaxScaler()
    scaled_data = scaler.fit_transform(series.values.reshape(-1, 1))
    
    X, y = [], []
    for i in range(len(scaled_data) - time_steps):
        X.append(scaled_data[i:i + time_steps])
        y.append(scaled_data[i + time_steps])
    
    X = np.array(X)
    y = np.array(y)
    return X, y, scaler

# Function to build and train LSTM model
def train_lstm(X, y, epochs=50, batch_size=32):
    model = Sequential([
        LSTM(50, activation='relu', input_shape=(X.shape[1], 1), return_sequences=True),
        LSTM(50, activation='relu'),
        Dense(1)
    ])
    model.compile(optimizer='adam', loss='mse')
    model.fit(X, y, epochs=epochs, batch_size=batch_size, verbose=0)
    return model

# Function to forecast
def forecast_sales(model, last_sequence, scaler, forecast_horizon):
    forecast = []
    current_sequence = last_sequence.copy()
    
    for _ in range(forecast_horizon):
        current_sequence_reshaped = current_sequence.reshape((1, current_sequence.shape[0], 1))
        next_pred = model.predict(current_sequence_reshaped, verbose=0)
        forecast.append(next_pred[0, 0])
        current_sequence = np.roll(current_sequence, -1)
        current_sequence[-1] = next_pred[0, 0]
    
    forecast = np.array(forecast).reshape(-1, 1)
    forecast = scaler.inverse_transform(forecast)
    return forecast.flatten()

# Main app
def main():
    # Header
    st.title("ğ Rossmore Sales Forecasting Dashboard")
    st.markdown("Analyze historical sales and forecast future trends for Rossmore stores.")

    # Sidebar
    with st.sidebar:
        st.header("âï¸ Settings")
        data = load_data()
        stores = data.columns.tolist()
        selected_stores = st.multiselect("Select Stores", stores, default=[stores[0]])
        forecast_horizon = st.slider("Forecast Horizon (Months)", 1, 24, 12)
        if st.button("Run Forecast"):
            st.session_state['run_forecast'] = True
        else:
            st.session_state['run_forecast'] = False

    # Main content
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.subheader("Historical Sales Trends")
        if selected_stores:
            fig = go.Figure()
            for store in selected_stores:
                fig.add_trace(go.Scatter(x=data.index, y=data[store], mode='lines', name=store))
            fig.update_layout(
                title="Historical Sales by Store",
                xaxis_title="Date",
                yaxis_title="Sales",
                template="plotly_white",
                height=400
            )
            st.plotly_chart(fig, use_container_width=True)
        else:
            st.warning("Please select at least one store.")

    with col2:
        st.subheader("Data Summary")
        if selected_stores:
            summary = data[selected_stores].describe()
            st.dataframe(summary.style.format("{:.2f}"), use_container_width=True)
        else:
            st.info("Select stores to view summary statistics.")

    # Forecasting section
    if st.session_state.get('run_forecast') and selected_stores:
        st.subheader("Sales Forecast")
        time_steps = 12
        tabs = st.tabs(selected_stores)
        
        for store, tab in zip(selected_stores, tabs):
            with tab:
                # Prepare data
                series = data[store].dropna()
                X, y, scaler = prepare_data(series, time_steps)
                
                # Train model
                model = train_lstm(X, y)
                
                # Forecast
                last_sequence = scaler.transform(series[-time_steps:].values.reshape(-1, 1))
                forecast = forecast_sales(model, last_sequence, scaler, forecast_horizon)
                
                # Create forecast dates
                last_date = series.index[-1]
                forecast_dates = [last_date + timedelta(days=30 * i) for i in range(1, forecast_horizon + 1)]
                
                # Plot forecast
                fig = go.Figure()
                fig.add_trace(go.Scatter(x=series.index[-24:], y=series[-24:], mode='lines', name='Historical'))
                fig.add_trace(go.Scatter(x=forecast_dates, y=forecast, mode='lines', name='Forecast', line=dict(dash='dash')))
                fig.update_layout(
                    title=f"Forecast for {store}",
                    xaxis_title="Date",
                    yaxis_title="Sales",
                    template="plotly_white",
                    height=400
                )
                st.plotly_chart(fig, use_container_width=True)
                
                # Display forecast values
                forecast_df = pd.DataFrame({"Date": forecast_dates, "Forecasted Sales": forecast})
                st.dataframe(forecast_df.style.format({"Forecasted Sales": "{:.2f}"}), use_container_width=True)

if __name__ == "__main__":
    main()